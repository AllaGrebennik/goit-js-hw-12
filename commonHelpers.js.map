{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict';\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from 'axios';\n\nconst form = document.querySelector(\".form\");\nconst qSearch = document.querySelector(\".input-text\");\nconst gallery = document.querySelector(\".gallery\");\nconst spinnerOnOff = document.querySelector(\".loader\");\nconst loadMoreFotos = document.querySelector(\".load-more-btn\")\n\nlet totalPages;\n\nspinnerOnOff.style.display = \"none\";\nloadMoreFotos.style.display = \"none\";\n\nlet searchParams = {\n    key: \"41702324-4ff2c897c89b5acf667452ea5\",\n    q: \"\",\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n    per_page: 40,\n    page: 1,\n};\n    \nconst lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n\nform.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    gallery.textContent = \"\";\n    searchParams.q = qSearch.value;\n    searchParams.page = 1;\n    await fetchFotos()\n});\n\nloadMoreFotos.addEventListener('click', async (e) => {\n    e.preventDefault();\n    searchParams.page++;\n    await fetchFotos();\n    window.scrollBy({\n        top: gallery.firstElementChild.getBoundingClientRect().height*2,\n        left: 0,\n        behavior: \"smooth\",\n    });\n});\n\nasync function fetchFotos() {\n    spinnerOnOff.style.display = \"block\"; \n    loadMoreFotos.style.display = \"none\";\n    const searchParamsCurrent = new URLSearchParams(searchParams);\n    return await axios.get(`https://pixabay.com/api/?${searchParamsCurrent}`)\n        .then((response) => {\n            totalPages = Math.ceil(response.data.totalHits / searchParams.per_page);\n            if (totalPages === 0) {\n                return iziToast.error({\n                    position: 'topRight',\n                    maxWidth: 350,\n                    message: \"Sorry, there are no images matching your search query. Please try again!\"\n                });\n            } else if (searchParams.page >= totalPages) {\n                iziToast.info({\n                    position: 'topRight',\n                    maxWidth: 350,\n                    message: \"We're sorry, but you've reached the end of search results.\"});\n            }\n            else loadMoreFotos.style.display = \"block\";\n            return renderFotos(response.data);\n        })\n        .catch((error) => {\n            return iziToast.error({\n                position: 'topRight',\n                title: \"Error\",\n                message: `${error.message}`\n            })\n        })\n        .finally(() => spinnerOnOff.style.display = \"none\");  \n};\n\nfunction renderFotos(fotos) {\n    const markup = fotos.hits.map(({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads\n    }) => `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n                class=\"gallery-image\"\n                src=\"${webformatURL}\"\n                alt=\"${tags}\"/>\n            </a>\n            <div class=\"info-item\">\n                <div class=\"info-image\">\n                    <h3 class=\"info-key\">Likes</h3>\n                    <p class=\"info-value\">${likes}</p>\n                </div>\n                <div class=\"info-image\">\n                    <h3 class=\"info-key\">Views</h3>\n                    <p class=\"info-value\">${views}</p>\n                </div>\n                <div class=\"info-image\">\n                    <h3 class=\"info-key\">Comments</h3>\n                    <p class=\"info-value\">${comments}</p>\n                </div>\n                <div class=\"info-image\">\n                    <h3 class=\"info-key\">Downloads</h3>\n                    <p class=\"info-value\">${downloads}</p>\n                </div>\n            </div>  \n        </li>`).join(\"\");\n    gallery.insertAdjacentHTML(\"beforeend\",markup);\n    lightbox.refresh();\n}"],"names":["form","qSearch","gallery","spinnerOnOff","loadMoreFotos","totalPages","searchParams","lightbox","SimpleLightbox","e","fetchFotos","searchParamsCurrent","axios","response","iziToast","renderFotos","error","fotos","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"owBAQA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,aAAa,EAC9CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAe,SAAS,cAAc,SAAS,EAC/CC,EAAgB,SAAS,cAAc,gBAAgB,EAE7D,IAAIC,EAEJF,EAAa,MAAM,QAAU,OAC7BC,EAAc,MAAM,QAAU,OAE9B,IAAIE,EAAe,CACf,IAAK,qCACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAM,CACV,EAEA,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAC9C,aAAc,MACd,aAAc,GAClB,CAAC,EAEDR,EAAK,iBAAiB,SAAU,MAAOS,GAAM,CACzCA,EAAE,eAAc,EAChBP,EAAQ,YAAc,GACtBI,EAAa,EAAIL,EAAQ,MACzBK,EAAa,KAAO,EACpB,MAAMI,EAAY,CACtB,CAAC,EAEDN,EAAc,iBAAiB,QAAS,MAAOK,GAAM,CACjDA,EAAE,eAAc,EAChBH,EAAa,OACb,MAAMI,EAAU,EAChB,OAAO,SAAS,CACZ,IAAKR,EAAQ,kBAAkB,sBAAuB,EAAC,OAAO,EAC9D,KAAM,EACN,SAAU,QAClB,CAAK,CACL,CAAC,EAED,eAAeQ,GAAa,CACxBP,EAAa,MAAM,QAAU,QAC7BC,EAAc,MAAM,QAAU,OAC9B,MAAMO,EAAsB,IAAI,gBAAgBL,CAAY,EAC5D,OAAO,MAAMM,EAAM,IAAI,4BAA4BD,GAAqB,EACnE,KAAME,IACHR,EAAa,KAAK,KAAKQ,EAAS,KAAK,UAAYP,EAAa,QAAQ,EAClED,IAAe,EACRS,EAAS,MAAM,CAClB,SAAU,WACV,SAAU,IACV,QAAS,0EAC7B,CAAiB,GACMR,EAAa,MAAQD,EAC5BS,EAAS,KAAK,CACV,SAAU,WACV,SAAU,IACV,QAAS,4DAA4D,CAAC,EAEzEV,EAAc,MAAM,QAAU,QAC5BW,EAAYF,EAAS,IAAI,GACnC,EACA,MAAOG,GACGF,EAAS,MAAM,CAClB,SAAU,WACV,MAAO,QACP,QAAS,GAAGE,EAAM,SAClC,CAAa,CACJ,EACA,QAAQ,IAAMb,EAAa,MAAM,QAAU,MAAM,CAC1D,CAEA,SAASY,EAAYE,EAAO,CACxB,MAAMC,EAASD,EAAM,KAAK,IAAI,CAAC,CAC3B,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAU;AAAA;AAAA,4CAEkCL;AAAA;AAAA;AAAA,uBAGrBD;AAAA,uBACAE;AAAA;AAAA;AAAA;AAAA;AAAA,4CAKqBC;AAAA;AAAA;AAAA;AAAA,4CAIAC;AAAA;AAAA;AAAA;AAAA,4CAIAC;AAAA;AAAA;AAAA;AAAA,4CAIAC;AAAA;AAAA;AAAA,cAG9B,EAAE,KAAK,EAAE,EACnBvB,EAAQ,mBAAmB,YAAYgB,CAAM,EAC7CX,EAAS,QAAO,CACpB"}